{"remainingRequest":"/home/runner/work/front-end/front-end/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/home/runner/work/front-end/front-end/src/views/project/PostsView.vue?vue&type=template&id=1ed9867c&ts=true","dependencies":[{"path":"/home/runner/work/front-end/front-end/src/views/project/PostsView.vue","mtime":1638848160323},{"path":"/home/runner/work/front-end/front-end/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/runner/work/front-end/front-end/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/runner/work/front-end/front-end/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":499162500000},{"path":"/home/runner/work/front-end/front-end/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/runner/work/front-end/front-end/node_modules/vue-loader-v16/dist/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgICA8ZGl2IGNsYXNzPSJ3LWZ1bGwiPgoKICAgICAgICA8UG9zdENhcmQKICAgICAgICAgICAgdi1mb3I9InBvc3QgaW4gcG9zdHMiCiAgICAgICAgICAgIDprZXk9Iidwb3N0XycrcG9zdC5pZCIKICAgICAgICAgICAgOnBvc3Q9InBvc3QiCiAgICAgICAgICAgIGNsYXNzPSJteS02IHNoYWRvdy1tZCIKICAgICAgICAgICAgPjwvUG9zdENhcmQ+CgogICAgICAgIDxkaXYgY2xhc3M9InctZnVsbCBmbGV4IGp1c3RpZnktY2VudGVyIj4KICAgICAgICAgICAgPGRpdiByZWY9ImxvYWRlciI+PC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgPC9kaXY+Cg=="},{"version":3,"sources":["/home/runner/work/front-end/front-end/src/views/project/PostsView.vue"],"names":[],"mappings":";IACI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;QAEf,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACJ,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;YACpB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACrB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACX,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACrB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;;QAEf,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACnC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3B,CAAC,CAAC,CAAC,CAAC,CAAC;;IAET,CAAC,CAAC,CAAC,CAAC,CAAC","file":"/home/runner/work/front-end/front-end/src/views/project/PostsView.vue","sourceRoot":"","sourcesContent":["<template>\n    <div class=\"w-full\">\n\n        <PostCard\n            v-for=\"post in posts\"\n            :key=\"'post_'+post.id\"\n            :post=\"post\"\n            class=\"my-6 shadow-md\"\n            ></PostCard>\n\n        <div class=\"w-full flex justify-center\">\n            <div ref=\"loader\"></div>\n        </div>\n\n    </div>\n</template>\n\n<script lang=\"ts\">\nimport {defineComponent} from 'vue'\nimport {API} from '@/api'\nimport PostCard from '@/components/cards/PostCard.vue'\nimport {Post, Project} from '@/models'\nimport lottie, {AnimationItem} from 'lottie-web';\n\nexport default defineComponent({\n    components: {\n        PostCard\n    },\n    data() {\n        return {\n            project: undefined as unknown as Project,\n            posts: new Array<Post>(),\n            currentPage: 1,\n            lastPage: undefined as unknown as number,\n            animation: undefined as unknown as AnimationItem\n        }\n    },\n    created() {\n        API.Project.get(Number(this.$route.params['id'])).then(response => {\n            switch (response.status) {\n                case 200:\n                    this.project = response.data\n\n                    API.Project.posts(this.project).then(response => {\n                      if (response.status == 200) {\n                        this.posts = response.data.data;\n                        this.currentPage = response.data.meta.current_page;\n                        this.lastPage = response.data.meta.last_page;\n                      }\n                    })\n                  break;\n\n              default:\n                break;\n            }\n        });\n    },\n    mounted() {\n        this.animation = lottie.loadAnimation({\n            container: this.$refs['loader'] as Element,\n            renderer: 'svg',\n            loop: true,\n            autoplay: false,\n            path: '/lottie/loading.json'\n        });\n        this.scroll();\n    },\n    beforeRouteUpdate(to, from, next) {\n        API.Project.get(Number(to.params['id'])).then(response => {\n            switch (response.status) {\n                case 200:\n                    this.project = response.data\n                    this.posts = [];\n\n                    API.Project.posts(this.project).then(response => {\n                        if (response.status == 200) {\n                            this.posts = response.data.data;\n                            this.currentPage = response.data.meta.current_page;\n                            this.lastPage = response.data.meta.last_page;\n                            next()\n                        }\n                    })\n                    break;\n\n                default:\n                    next(false)\n                    break;\n            }\n        });\n    },\n    methods: {\n        scroll() {\n            window.onscroll = () => {\n                let bottomOfWindow = document.documentElement.scrollTop + window.innerHeight === document.documentElement.offsetHeight;\n\n                if (bottomOfWindow && this.lastPage != undefined && this.currentPage < this.lastPage) {\n                    this.animation.play()\n                    API.Project.posts(this.project, this.currentPage+1).then(response => {\n                        if (response.status == 200) {\n                            this.posts.push(...response.data.data);\n                            this.currentPage = response.data.meta.current_page;\n                            this.lastPage = response.data.meta.last_page;\n                            this.animation.stop()\n                        }\n                    });\n                }\n            }\n        }\n    }\n})\n</script>\n\n<style scoped>\n\n</style>\n"]}]}